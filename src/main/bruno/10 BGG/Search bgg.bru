meta {
  name: Search bgg
  type: http
  seq: 1
}

get {
  url: {{server}}/api/bgg/search/{{searchTerm}}
  body: none
  auth: none
}

headers {
  Authorization: Bearer {{access_token}}
}

vars:pre-request {
  searchTerm: Frosthaven
}

assert {
  res.status: eq 200
}

script:post-response {
  if (res.status == 200) {
    const bggIds = res.body.map(game => game.id).join(',')
    bru.setVar("bggIds", bggIds)
  }
}
